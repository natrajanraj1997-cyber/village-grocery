<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Village Grocery Delivery</title>

<style>
:root {
  --primary: #2e7d32;
  --primary-light: #4caf50;
  --primary-dark: #1b5e20;
  --secondary: #ff9800;
  --secondary-light: #ffb74d;
  --light: #f8f9fa;
  --lighter: #fefefe;
  --card: #ffffff;
  --border: #e8f5e9;
  --text: #333333;
  --text-light: #666666;
  --text-lighter: #888888;
  --shadow: rgba(46, 125, 50, 0.1);
  --shadow-light: rgba(0, 0, 0, 0.05);
  --radius: 16px;
  --radius-sm: 12px;
  --radius-full: 999px;
  --transition: all 0.3s ease;
  --sidebar-width: 280px;
}

* {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
}

body {
  font-family: 'Segoe UI', 'Roboto', -apple-system, BlinkMacSystemFont, sans-serif;
  background: linear-gradient(135deg, #e8f5e9 0%, #f1f8e9 100%);
  color: var(--text);
  line-height: 1.5;
  min-height: 100vh;
}

/* Header */
header {
  background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
  color: white;
  padding: 20px;
  text-align: center;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
  position: relative;
}

.header-content {
  display: flex;
  justify-content: space-between;
  align-items: center;
  max-width: 800px;
  margin: 0 auto;
}

.logo {
  font-weight: 700;
  font-size: 1.8rem;
  letter-spacing: 0.5px;
  display: flex;
  align-items: center;
  gap: 10px;
}

.logo::before {
  content: "üåæ";
}

.cart-indicator {
  background: rgba(255, 255, 255, 0.2);
  padding: 10px 20px;
  border-radius: var(--radius-full);
  font-weight: 600;
  display: flex;
  align-items: center;
  gap: 8px;
}

/* Login Container */
.login-container {
  max-width: 450px;
  margin: 40px auto;
  padding: 0 20px;
}

.login-card {
  background: var(--card);
  border-radius: var(--radius);
  padding: 40px 35px;
  box-shadow: 0 10px 30px rgba(0, 0, 0, 0.12);
  border: 1px solid var(--border);
  text-align: center;
}

.login-title {
  font-size: 1.8rem;
  color: var(--primary-dark);
  margin-bottom: 10px;
  font-weight: 600;
}

.login-subtitle {
  color: var(--text-light);
  margin-bottom: 30px;
  font-size: 1rem;
}

/* Input Groups */
.input-group {
  margin-bottom: 20px;
  text-align: left;
}

.input-group label {
  display: block;
  margin-bottom: 8px;
  color: var(--text);
  font-weight: 500;
  font-size: 0.95rem;
}

.input-group input {
  width: 100%;
  padding: 16px 20px;
  border-radius: var(--radius-sm);
  border: 1.5px solid #e0e0e0;
  font-size: 16px;
  background: var(--lighter);
  transition: var(--transition);
}

.input-group input:focus {
  outline: none;
  border-color: var(--primary);
  box-shadow: 0 0 0 3px rgba(46, 125, 50, 0.1);
}

/* Buttons */
.btn-primary, .btn-ghost {
  width: 100%;
  padding: 16px;
  border-radius: var(--radius-full);
  border: none;
  font-size: 16px;
  font-weight: 600;
  cursor: pointer;
  transition: var(--transition);
  margin: 10px 0;
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 10px;
}

.btn-primary {
  background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);
  color: white;
  box-shadow: 0 4px 15px rgba(46, 125, 50, 0.3);
}

.btn-primary:hover {
  transform: translateY(-2px);
  box-shadow: 0 6px 20px rgba(46, 125, 50, 0.4);
}

.btn-ghost {
  background: white;
  border: 1.5px solid var(--primary);
  color: var(--primary);
}

.btn-ghost:hover {
  background: rgba(46, 125, 50, 0.05);
  transform: translateY(-2px);
}

/* Divider */
.divider {
  display: flex;
  align-items: center;
  text-align: center;
  margin: 25px 0;
  color: var(--text-lighter);
  font-size: 0.9rem;
}

.divider::before,
.divider::after {
  content: '';
  flex: 1;
  border-bottom: 1px solid #e0e0e0;
}

.divider span {
  padding: 0 15px;
}

/* Footer */
.login-footer {
  margin-top: 25px;
  padding-top: 20px;
  border-top: 1px solid var(--border);
  color: var(--text-light);
  font-size: 0.9rem;
}

/* Hide shop area initially */
#shopArea {
  display: none;
}

/* Loading animation */
.loading {
  display: inline-block;
  width: 20px;
  height: 20px;
  border: 2px solid rgba(255, 255, 255, 0.3);
  border-radius: 50%;
  border-top-color: white;
  animation: spin 1s ease-in-out infinite;
  margin-left: 10px;
}

@keyframes spin {
  to { transform: rotate(360deg); }
}

/* Small text */
.small {
  font-size: 0.9rem;
  color: var(--text-light);
  line-height: 1.5;
}

/* Responsive */
@media (max-width: 768px) {
  .login-container {
    margin: 20px auto;
    padding: 0 15px;
  }
  
  .login-card {
    padding: 30px 25px;
  }
  
  .header-content {
    flex-direction: column;
    gap: 15px;
  }
  
  .logo {
    font-size: 1.5rem;
  }
}

/* OTP Section */
.otp-section {
  margin-top: 25px;
  padding-top: 25px;
  border-top: 1px solid var(--border);
  animation: fadeIn 0.5s ease;
}

@keyframes fadeIn {
  from { opacity: 0; transform: translateY(10px); }
  to { opacity: 1; transform: translateY(0); }
}

/* Error/Success Messages */
.message {
  padding: 12px 20px;
  border-radius: var(--radius-sm);
  margin-bottom: 20px;
  font-size: 0.95rem;
  display: none;
}

.message.success {
  background: rgba(76, 175, 80, 0.1);
  color: var(--primary);
  border-left: 4px solid var(--primary);
  display: block;
}

.message.error {
  background: rgba(244, 67, 54, 0.1);
  color: #f44336;
  border-left: 4px solid #f44336;
  display: block;
}
</style>
</head>

<body>

<!-- Header -->
<header>
  <div class="header-content">
    <div class="logo">Village Grocery</div>
    <div class="cart-indicator">
      üõí <span id="count">0</span>
    </div>
  </div>
</header>

<!-- Login Container -->
<div class="login-container">
  <div class="login-card">
    <h2 class="login-title">Village Grocery</h2>
    <p class="login-subtitle">Login to continue</p>
    
    <!-- Messages -->
    <div id="message" class="message"></div>
    
    <!-- BEFORE LOGIN -->
    <div id="loginBox">
      <div class="input-group">
        <label for="loginName">Your name</label>
        <input id="loginName" placeholder="Enter your name" autocomplete="name">
      </div>
      
      <div class="input-group">
        <label for="loginMobile">Phone number (with or without +91)</label>
        <input id="loginMobile" placeholder="Enter your phone number" autocomplete="tel">
      </div>
      
      <div id="recaptcha-container"></div>
      
      <button class="btn-primary" type="button" onclick="sendOtp()">
        <span>Send OTP</span>
      </button>
      
      <!-- OTP Section (hidden initially) -->
      <div id="otpSection" class="otp-section" style="display: none;">
        <div class="input-group">
          <label for="otpCode">Enter OTP</label>
          <input id="otpCode" placeholder="Enter the OTP sent to your phone" autocomplete="one-time-code">
        </div>
        
        <button class="btn-primary" type="button" onclick="verifyOtp()">
          <span>Verify OTP</span>
        </button>
      </div>
      
      <div class="divider">
        <span>or</span>
      </div>
      
      <button class="btn-ghost" type="button" onclick="googleLogin()">
        <span>Sign in with Google</span>
      </button>
      
      <div class="login-footer">
        <p class="small">After login you can browse products, add to cart, and place orders.</p>
      </div>
    </div>
    
    <!-- AFTER LOGIN (hidden initially) -->
    <div id="userBox" style="display:none">
      <div style="text-align: center; margin: 30px 0;">
        <div style="font-size: 4rem; margin-bottom: 20px;">‚úÖ</div>
        <h3 style="color: var(--primary); margin-bottom: 10px;">Login Successful!</h3>
        <p class="small" id="welcomeText"></p>
      </div>
      
      <button class="btn-primary" type="button" onclick="enterShop()">
        <span>Enter Shop</span>
      </button>
      
      <button class="btn-ghost" type="button" onclick="logout()">
        <span>Logout</span>
      </button>
    </div>
  </div>
</div>

<!-- SHOP AREA: hidden until login -->
<div id="shopArea">
  <!-- Sidebar will be loaded here dynamically -->
</div>

<!-- FIREBASE -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
import { 
  getFirestore, collection, addDoc, serverTimestamp, onSnapshot, query, where, orderBy
} from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";
import {
  getAuth,
  RecaptchaVerifier,
  signInWithPhoneNumber,
  signOut,
  onAuthStateChanged,
  GoogleAuthProvider,
  signInWithPopup
} from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";

const firebaseConfig = {
  apiKey: "AIzaSyCYDLsQLFvuTV1N0mXtZFVYcSQqOkGfCrE",
  authDomain: "grocery-orders-3ce26.firebaseapp.com",
  projectId: "grocery-orders-3ce26",
  storageBucket: "grocery-orders-3ce26.appspot.com",
  messagingSenderId: "786501136156",
  appId: "1:786501136156:web:9277a2f7ef937deff1d4d9"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);
const auth = getAuth(app);
const googleProvider = new GoogleAuthProvider();

// DOM Elements
const count = document.getElementById("count");
const loginName = document.getElementById("loginName");
const loginMobile = document.getElementById("loginMobile");
const otpCode = document.getElementById("otpCode");
const loginBox = document.getElementById("loginBox");
const userBox = document.getElementById("userBox");
const welcomeText = document.getElementById("welcomeText");
const otpSection = document.getElementById("otpSection");
const messageEl = document.getElementById("message");
const shopArea = document.getElementById("shopArea");

let data = [];
let cart = {};

// reCAPTCHA + OTP
let recaptchaVerifier;
let confirmationResultGlobal = null;

// Show message function
function showMessage(text, type = 'info') {
  messageEl.textContent = text;
  messageEl.className = 'message';
  if (type === 'success') {
    messageEl.classList.add('success');
  } else if (type === 'error') {
    messageEl.classList.add('error');
  }
  messageEl.style.display = 'block';
}

// Hide message function
function hideMessage() {
  messageEl.style.display = 'none';
}

// init invisible reCAPTCHA for phone auth
function initRecaptcha() {
  recaptchaVerifier = new RecaptchaVerifier(auth, 'recaptcha-container', {
    size: 'invisible'
  });
}
initRecaptcha();

// PHONE AUTH
window.sendOtp = async () => {
  const name = loginName.value.trim();
  const phone = loginMobile.value.trim();
  
  if (!name) {
    showMessage("Please enter your name", 'error');
    return;
  }
  
  if (!phone) {
    showMessage("Please enter your phone number", 'error');
    return;
  }
  
  let formattedPhone = phone;
  if (!formattedPhone.startsWith("+")) {
    formattedPhone = "+91" + formattedPhone;
  }
  
  if (formattedPhone.length < 12) {
    showMessage("Please enter a valid phone number", 'error');
    return;
  }
  
  try {
    showMessage("Sending OTP...", 'success');
    confirmationResultGlobal = await signInWithPhoneNumber(auth, formattedPhone, recaptchaVerifier);
    otpSection.style.display = 'block';
    showMessage("OTP sent successfully to your phone!", 'success');
  } catch (e) {
    console.error(e);
    showMessage("Failed to send OTP. Please try again.", 'error');
  }
};

window.verifyOtp = async () => {
  const otp = otpCode.value.trim();
  
  if (!otp) {
    showMessage("Please enter the OTP", 'error');
    return;
  }
  
  if (!confirmationResultGlobal) {
    showMessage("Please request an OTP first", 'error');
    return;
  }
  
  try {
    showMessage("Verifying OTP...", 'success');
    await confirmationResultGlobal.confirm(otp);
    // Success message will be shown by auth state change
  } catch (e) {
    console.error(e);
    showMessage("Invalid OTP. Please try again.", 'error');
  }
};

// GOOGLE AUTH
window.googleLogin = async () => {
  try {
    showMessage("Signing in with Google...", 'success');
    await signInWithPopup(auth, googleProvider);
    // Success message will be shown by auth state change
  } catch (e) {
    console.error(e);
    showMessage("Google sign-in failed. Please try again.", 'error');
  }
};

window.logout = async () => {
  try {
    await signOut(auth);
    showMessage("Logged out successfully", 'success');
  } catch (e) {
    console.error(e);
    showMessage("Logout failed. Please try again.", 'error');
  }
};

// Enter shop after successful login
window.enterShop = function() {
  // Load the shop interface
  loadShopInterface();
};

// Load shop interface
function loadShopInterface() {
  // Hide login container
  document.querySelector('.login-container').style.display = 'none';
  
  // Load shop HTML
  shopArea.innerHTML = `
    <style>
      /* Shop Styles */
      .shop-container {
        display: flex;
        min-height: calc(100vh - 80px);
      }
      
      .sidebar {
        width: 280px;
        background: white;
        box-shadow: 2px 0 10px rgba(0, 0, 0, 0.08);
        padding: 20px 0;
      }
      
      .customer-profile {
        padding: 20px;
        text-align: center;
        border-bottom: 1px solid var(--border);
      }
      
      .profile-image {
        width: 60px;
        height: 60px;
        border-radius: 50%;
        background: var(--primary-light);
        margin: 0 auto 15px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 24px;
        color: white;
      }
      
      .customer-name {
        font-weight: 600;
        margin-bottom: 5px;
      }
      
      .customer-email {
        font-size: 0.9rem;
        color: var(--text-light);
      }
      
      .menu {
        padding: 20px 0;
      }
      
      .menu-item {
        padding: 15px 20px;
        display: flex;
        align-items: center;
        gap: 15px;
        cursor: pointer;
        transition: var(--transition);
        border-left: 3px solid transparent;
      }
      
      .menu-item:hover, .menu-item.active {
        background: rgba(46, 125, 50, 0.05);
        border-left: 3px solid var(--primary);
      }
      
      .menu-icon {
        font-size: 20px;
        width: 24px;
        text-align: center;
      }
      
      .main-content {
        flex: 1;
        padding: 30px;
        background: #f8f9fa;
      }
      
      .top-bar {
        background: white;
        padding: 15px 25px;
        border-radius: var(--radius);
        margin-bottom: 25px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
        display: flex;
        align-items: center;
        gap: 20px;
      }
      
      .search-input {
        flex: 1;
        padding: 12px 20px;
        border: 1px solid var(--border);
        border-radius: var(--radius-full);
        font-size: 16px;
      }
      
      .products-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
        gap: 20px;
      }
      
      .product-card {
        background: white;
        border-radius: var(--radius);
        padding: 20px;
        box-shadow: 0 4px 12px var(--shadow);
        transition: var(--transition);
      }
      
      .product-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
      }
      
      .cart-bar {
        position: fixed;
        bottom: 0;
        left: 280px;
        right: 0;
        background: white;
        padding: 20px 30px;
        box-shadow: 0 -4px 20px rgba(0, 0, 0, 0.1);
        display: flex;
        justify-content: space-between;
        align-items: center;
      }
      
      @media (max-width: 768px) {
        .shop-container {
          flex-direction: column;
        }
        
        .sidebar {
          width: 100%;
          height: auto;
        }
        
        .cart-bar {
          left: 0;
        }
      }
    </style>
    
    <div class="shop-container">
      <!-- Sidebar -->
      <div class="sidebar">
        <div class="customer-profile">
          <div class="profile-image" id="profileImage">U</div>
          <div class="customer-name" id="shopCustomerName">Customer</div>
          <div class="customer-email" id="shopCustomerEmail">email@example.com</div>
        </div>
        
        <div class="menu">
          <div class="menu-item active" onclick="showSection('products')">
            <div class="menu-icon">üõçÔ∏è</div>
            <div>All Products</div>
          </div>
          
          <div class="menu-item" onclick="showSection('categories')">
            <div class="menu-icon">üóÇÔ∏è</div>
            <div>Categories</div>
          </div>
          
          <div class="menu-item" onclick="showSection('cart')">
            <div class="menu-icon">üõí</div>
            <div>Cart</div>
            <div class="cart-count" style="margin-left: auto; background: var(--secondary); color: white; padding: 2px 8px; border-radius: 10px; font-size: 0.8rem;" id="sidebarCartCount">0</div>
          </div>
          
          <div class="menu-item" onclick="showSection('history')">
            <div class="menu-icon">üìú</div>
            <div>Order History</div>
          </div>
          
          <div class="menu-item" onclick="logout()">
            <div class="menu-icon">üö™</div>
            <div>Logout</div>
          </div>
        </div>
      </div>
      
      <!-- Main Content -->
      <div class="main-content">
        <div class="top-bar">
          <input type="text" class="search-input" placeholder="Search products..." id="shopSearch">
          <button onclick="placeOrder()" style="padding: 12px 30px; background: var(--primary); color: white; border: none; border-radius: var(--radius); cursor: pointer; font-weight: 600;">
            Place Order
          </button>
        </div>
        
        <div id="shopContent">
          <!-- Products will be loaded here -->
          <div class="products-grid" id="productsGrid"></div>
        </div>
      </div>
    </div>
    
    <!-- Cart Bar -->
    <div class="cart-bar">
      <div style="font-size: 1.2rem; font-weight: 600;">
        Total: ‚Çπ<span id="shopTotal">0</span>
      </div>
      <button onclick="placeOrder()" style="padding: 15px 40px; background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%); color: white; border: none; border-radius: var(--radius-full); cursor: pointer; font-weight: 600; font-size: 1.1rem;">
        Place Order
      </button>
    </div>
  `;
  
  // Initialize shop functionality
  initializeShop();
}

// Initialize shop functionality
function initializeShop() {
  // Update profile info
  const user = auth.currentUser;
  if (user) {
    const profileImage = document.getElementById('profileImage');
    const shopCustomerName = document.getElementById('shopCustomerName');
    const shopCustomerEmail = document.getElementById('shopCustomerEmail');
    
    const userName = loginName.value.trim() || user.displayName || "Customer";
    shopCustomerName.textContent = userName;
    shopCustomerEmail.textContent = user.email || "Logged in";
    
    // Set profile initials
    const initials = userName.split(' ').map(n => n[0]).join('').toUpperCase();
    profileImage.textContent = initials.length > 1 ? initials.substring(0, 2) : initials;
  }
  
  // Load products
  loadProducts();
}

// Load products from Firebase
function loadProducts() {
  const productsRef = collection(db, "products");
  onSnapshot(productsRef, (snapshot) => {
    data = snapshot.docs.map(doc => {
      const d = doc.data();
      return {
        id: doc.id,
        name: d.Name,
        price: d.price,
        cat: d.cat,
        img: d.img,
        inStock: d.stock,
        unit: d.unit
      };
    });
    renderProducts();
  }, (error) => console.error(error));
}

// Render products
function renderProducts() {
  const productsGrid = document.getElementById('productsGrid');
  if (!productsGrid) return;
  
  productsGrid.innerHTML = '';
  
  data.forEach(p => {
    const qty = cart[p.id]?.qty || 0;
    
    const productCard = document.createElement('div');
    productCard.className = 'product-card';
    productCard.innerHTML = `
      <img src="${p.img}" alt="${p.name}" style="width: 100%; height: 150px; object-fit: cover; border-radius: var(--radius-sm); margin-bottom: 15px;" onerror="this.src='https://via.placeholder.com/300x200?text=Product'">
      <h3 style="margin-bottom: 10px; font-size: 1.1rem;">${p.name}</h3>
      <div style="color: var(--text-light); margin-bottom: 10px; font-size: 0.9rem;">${p.unit || 'Each'}</div>
      <div style="color: var(--primary); font-weight: 700; font-size: 1.2rem; margin-bottom: 15px;">‚Çπ${p.price}</div>
      
      ${p.inStock ? `
        ${qty > 0 ? `
          <div style="display: flex; align-items: center; gap: 10px;">
            <button onclick="chg('${p.id}', -1)" style="padding: 8px 16px; background: white; border: 1px solid var(--primary); border-radius: 20px; cursor: pointer;">-</button>
            <span style="font-weight: 600;">${qty}</span>
            <button onclick="chg('${p.id}', 1)" style="padding: 8px 16px; background: var(--primary); color: white; border: none; border-radius: 20px; cursor: pointer;">+</button>
          </div>
        ` : `
          <button onclick="add('${p.id}')" style="width: 100%; padding: 12px; background: var(--primary); color: white; border: none; border-radius: var(--radius); cursor: pointer; font-weight: 600;">
            Add to Cart
          </button>
        `}
      ` : `
        <button disabled style="width: 100%; padding: 12px; background: #ccc; color: #666; border: none; border-radius: var(--radius); cursor: not-allowed;">
          Out of Stock
        </button>
      `}
    `;
    
    productsGrid.appendChild(productCard);
  });
}

// Cart functions
window.add = function(id) {
  const product = data.find(p => p.id === id);
  if (!product) return;
  
  if (!cart[id]) {
    cart[id] = { qty: 1, price: product.price, name: product.name };
  } else {
    cart[id].qty += 1;
  }
  
  updateCart();
};

window.chg = function(id, delta) {
  if (!cart[id]) return;
  
  cart[id].qty += delta;
  if (cart[id].qty <= 0) {
    delete cart[id];
  }
  
  updateCart();
};

function updateCart() {
  let total = 0;
  let itemCount = 0;
  
  for (let id in cart) {
    total += cart[id].qty * cart[id].price;
    itemCount += cart[id].qty;
  }
  
  // Update cart indicators
  count.textContent = itemCount;
  
  const sidebarCartCount = document.getElementById('sidebarCartCount');
  if (sidebarCartCount) {
    sidebarCartCount.textContent = itemCount;
  }
  
  const shopTotal = document.getElementById('shopTotal');
  if (shopTotal) {
    shopTotal.textContent = total;
  }
  
  // Re-render products to update quantities
  renderProducts();
}

// Show different sections
window.showSection = function(section) {
  // Update menu active state
  document.querySelectorAll('.menu-item').forEach(item => item.classList.remove('active'));
  event.target.closest('.menu-item').classList.add('active');
  
  // Show appropriate content
  // (Implementation depends on your specific section requirements)
};

// Place order function
window.placeOrder = async function() {
  const user = auth.currentUser;
  if (!user) {
    showMessage("Please login first", 'error');
    return;
  }
  
  if (Object.keys(cart).length === 0) {
    showMessage("Please add items to cart first", 'error');
    return;
  }
  
  try {
    await addDoc(collection(db, "orders"), {
      name: loginName.value.trim() || user.displayName || "Customer",
      mobile: loginMobile.value.trim() || user.phoneNumber || "",
      items: cart,
      status: "NEW",
      createdAt: serverTimestamp(),
      userId: user.uid,
      userEmail: user.email || null
    });
    
    showMessage("Order placed successfully!", 'success');
    cart = {};
    updateCart();
  } catch (error) {
    console.error("Error placing order:", error);
    showMessage("Error placing order. Please try again.", 'error');
  }
};

// auth state listener
onAuthStateChanged(auth, (user) => {
  if (user) {
    // User is logged in
    loginBox.style.display = "none";
    userBox.style.display = "block";
    
    const label = loginName.value.trim() || user.displayName || user.email || "Customer";
    welcomeText.textContent = `Welcome, ${label}!`;
    
    // Clear any messages
    hideMessage();
    
    // Show success message
    showMessage("Login successful! Click 'Enter Shop' to continue.", 'success');
    
  } else {
    // User is logged out
    loginBox.style.display = "block";
    userBox.style.display = "none";
    otpSection.style.display = "none";
    shopArea.style.display = "none";
    document.querySelector('.login-container').style.display = 'block';
    
    // Clear form fields
    loginName.value = '';
    loginMobile.value = '';
    otpCode.value = '';
    
    // Reset cart
    cart = {};
    updateCart();
  }
});

// Initialize cart count
updateCart();
</script>

</body>
</html>